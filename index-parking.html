<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link href="index-parking.css" rel="stylesheet">
    <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <title>emma</title>
    <link rel="icon" href="/Imagenes/16.png" type="image/x-icon">
</head>
<body>
    <nav class="navbar navbar-expand-lg" style="background-color: #b30000;">
        <div class="container-fluid">
          <button class="navbar-toggler d-lg-block" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasMenu" aria-controls="offcanvasMenu" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <a class="navbar-brand mx-auto text-white" href="#">MI ESTACIONAMIENTO</a>
        </div>
      </nav>
      
      <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasMenu" aria-labelledby="offcanvasMenuLabel">
        <div class="offcanvas-header">
          <img src="/Imagenes/emma_logoBoton.svg" alt="Emma Logo" width="150" height="150" class="me-2">
          <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
          <ul class="list-unstyled">
            <div id="imagen-usuario-container" style="width: 150px; height: auto;">
              <img id="imagen-usuario" src="" alt="Imagen del Usuario" style="display: none; width: 100%; height: auto;">
              <p id="nombre-usuario"></p>
           </div>
  
            <li><a href="#" class="nav-link menu-item"><img src="/Imagenes/BotonIcons/home.png" class="me-2" width="20" height="20" alt="Inicio">Inicio</a></li>
            <li><a href="#" class="nav-link menu-item"><img src="/Imagenes/BotonIcons/Practicas.png" class="me-2" width="20" height="20" alt="Prácticas">Prácticas</a></li>
            <li><a href="#" class="nav-link menu-item"><img src="/Imagenes/BotonIcons/Becas.png" class="me-2" width="20" height="20" alt="Becas">Becas</a></li>  
            <li><a href="#" class="nav-link menu-item"> <img src="/Imagenes/BotonIcons/Procesos Academicos.png" class="me-2" width="20" height="20" alt="Becas">Procesos Académicos</a></li>
            <li><a href="#" class="nav-link menu-item"><img src="/Imagenes/BotonIcons/Procesos Financieros.png" class="me-2" width="20" height="20" alt="Becas">Procesos Financieros</a></li>
            <li><a href="#" class="nav-link menu-item"><img src="/Imagenes/BotonIcons/Consultas.png" class="me-2" width="20" height="20" alt="Becas">Consultas</a></li>
            <li><a href="#" class="nav-link menu-item"><img src="/Imagenes/BotonIcons/Valicaciones.png" class="me-2" width="20" height="20" alt="Becas">Validaciones</a></li>
            <li><a href="#" class="nav-link menu-item"><img src="/Imagenes/BotonIcons/REA.png" class="me-2" width="20" height="20" alt="Becas">REA</a></li>
            <li><a href="#" class="nav-link menu-item"><img src="/Imagenes/BotonIcons/Portal Empleo.png" class="me-2" width="20" height="20" alt="Becas">Portal Empleo/CUC JOBS</a></li>
            <li><a href="#" class="nav-link menu-item"><img src="/Imagenes/BotonIcons/Semilleros.png" class="me-2" width="20" height="20" alt="Becas">Semilleros de Investigación e Innovación</a></li>
            <li><a href="#" class="nav-link menu-item"><img src="/Imagenes/BotonIcons/Opciones de grados.png" class="me-2" width="20" height="20" alt="Becas">Opciones de Grados</a></li>
            <li><a href="#" class="nav-link menu-item"><img src="/Imagenes/BotonIcons/Retos Seguimiento.png" class="me-2" width="20" height="20" alt="Becas">Retos Seguimiento</a></li>
            <li><a href="#" class="nav-link menu-item"><img src="/Imagenes/BotonIcons/Atención.png" class="me-2" width="20" height="20" alt="Becas">Atención</a></li>
            <li><a href="#" class="nav-link menu-item"><img src="/Imagenes/BotonIcons/AutoGestion.png" class="me-2" width="20" height="20" alt="Becas">Autogestión Estudiantil</a></li>
          </ul>
        </div>
      </div>



    
      <div class="section1 section.my">
        <div class="image-container">
            <img src="/Imagenes/logo emma.png" alt="ImagenEmma" class="center-image">
        </div>

    <div class="sectionButton section.my"></div>
    <div class="button-container">
        <button><img src="Imagenes/BotonIcons/Icono-Agregar.png" alt="Icono 1"><span>Agregar</span></button>
        <button><img src="Imagenes/BotonIcons/Icono-Reserva.png" alt="Icono 2"><span>Reservar</span></button>
        <button><img src="Imagenes/BotonIcons/Icono-Remover.png" alt="Icono 3"><span>Eliminar</span></button>
        
      </div>
      
  
  
  <div class="card-container">
      <div class="card">
          <div class="card-text">Espacio 1 - Vacío</div>
          <div class="nombre">Nombre - XXXXXXXX</div>
          <div class="matricula">Matrícula - XXXXXXXX</div>
          <div class="hora">Hora - XX:XX</div>
          <div class="fecha">Fecha - XX/XX/XXXX</div>
      </div>
      <div class="card">
          <div class="card-text">Espacio 2 - Vacío</div>
          <div class="nombre">Nombre - XXXXXXXX</div>
          <div class="matricula">Matrícula - XXXXXXXX</div>
          <div class="hora">Hora - XX:XX</div>
          <div class="fecha">Fecha - XX/XX/XXXX</div>
      </div>
      <div class="card">
          <div class="card-text">Espacio 3 - Vacío</div>
          <div class="nombre">Nombre - XXXXXXXX</div>
          <div class="matricula">Matrícula - XXXXXXXX</div>
          <div class="hora">Hora - XX:XX</div>
          <div class="fecha">Fecha - XX/XX/XXXX</div>
      </div>
      <div class="card">
          <div class="card-text">Espacio 4 - Vacío</div>
          <div class="nombre">Nombre - XXXXXXXX</div>
          <div class="matricula">Matrícula - XXXXXXXX</div>
          <div class="hora">Hora - XX:XX</div>
          <div class="fecha">Fecha - XX/XX/XXXX</div>
      </div>
      <div class="card">
          <div class="card-text">Espacio 5 - Vacío</div>
          <div class="nombre">Nombre - XXXXXXXX</div>
          <div class="matricula">Matrícula - XXXXXXXX</div>
          <div class="hora">Hora - XX:XX</div>
          <div class="fecha">Fecha - XX/XX/XXXX</div>
      </div>
      <div class="card">
          <div class="card-text">Espacio 6 - Vacío</div>
          <div class="nombre">Nombre - XXXXXXXX</div>
          <div class="matricula">Matrícula - XXXXXXXX</div>
          <div class="hora">Hora - XX:XX</div>
          <div class="fecha">Fecha - XX/XX/XXXX</div>
      </div>
      <div class="card">
          <div class="card-text">Espacio 7 - Vacío</div>
          <div class="nombre">Nombre - XXXXXXXX</div>
          <div class="matricula">Matrícula - XXXXXXXX</div>
          <div class="hora">Hora - XX:XX</div>
          <div class="fecha">Fecha - XX/XX/XXXX</div>
      </div>
      <div class="card">
          <div class="card-text">Espacio 8 - Vacío</div>
          <div class="nombre">Nombre - XXXXXXXX</div>
          <div class="matricula">Matrícula - XXXXXXXX</div>
          <div class="hora">Hora - XX:XX</div>
          <div class="fecha">Fecha - XX/XX/XXXX</div>
      </div>
      <div class="card">
          <div class="card-text">Espacio 9 - Vacío</div>
          <div class="nombre">Nombre - XXXXXXXX</div>
          <div class="matricula">Matrícula - XXXXXXXX</div>
          <div class="hora">Hora - XX:XX</div>
          <div class="fecha">Fecha - XX/XX/XXXX</div>
      </div>
      <div class="card">
          <div class="card-text">Espacio 10 - Vacío</div>
          <div class="nombre">Nombre - XXXXXXXX</div>
          <div class="matricula">Matrícula - XXXXXXXX</div>
          <div class="hora">Hora - XX:XX</div>
          <div class="fecha">Fecha - XX/XX/XXXX</div>
      </div>
      <div class="card">
          <div class="card-text">Espacio 11 - Vacío</div>
          <div class="nombre">Nombre - XXXXXXXX</div>
          <div class="matricula">Matrícula - XXXXXXXX</div>
          <div class="hora">Hora - XX:XX</div>
          <div class="fecha">Fecha - XX/XX/XXXX</div>
      </div>
      <div class="card">
          <div class="card-text">Espacio 12 - Vacío</div>
          <div class="nombre">Nombre - XXXXXXXX</div>
          <div class="matricula">Matrícula - XXXXXXXX</div>
          <div class="hora">Hora - XX:XX</div>
          <div class="fecha">Fecha - XX/XX/XXXX</div>
      </div>
      <div class="card">
          <div class="card-text">Espacio 13 - Vacío</div>
          <div class="nombre">Nombre - XXXXXXXX</div>
          <div class="matricula">Matrícula - XXXXXXXX</div>
          <div class="hora">Hora - XX:XX</div>
          <div class="fecha">Fecha - XX/XX/XXXX</div>
      </div>
      <div class="card">
          <div class="card-text">Espacio 14 - Vacío</div>
          <div class="nombre">Nombre - XXXXXXXX</div>
          <div class="matricula">Matrícula - XXXXXXXX</div>
          <div class="hora">Hora - XX:XX</div>
          <div class="fecha">Fecha - XX/XX/XXXX</div>
      </div>
      <div class="card">
          <div class="card-text">Espacio 15 - Vacío</div>
          <div class="nombre">Nombre - XXXXXXXX</div>
          <div class="matricula">Matrícula - XXXXXXXX</div>
          <div class="hora">Hora - XX:XX</div>
          <div class="fecha">Fecha - XX/XX/XXXX</div>
      </div>
  </div>
  <footer class="navbar navbar-expand-lg fixed-bottom" style="background-color: #f8f9fa; text-decoration: none; transition: background-color 0.3s, box-shadow 0.3s; border-top: 1px solid #dee2e6; height: 30px;">
    <div class="container-fluid d-flex justify-content-between align-items-center" style="font-size: 0.8rem;">
      <span class="navbar-text mx-auto text-muted">
        Copyright &copy; <a href="https://www.cuc.edu.co/">Universidad de la Costa CUC</a> 2024.
      </span>
    </div>
</footer>
      
      
</body>
 
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
<script>
  document.addEventListener('DOMContentLoaded', () => {
      const usuarioAutenticado = JSON.parse(localStorage.getItem('usuarioAutenticado'));

      if (usuarioAutenticado) {
          // Mostrar información del usuario
          const imagenUsuario = document.getElementById('imagen-usuario');
          imagenUsuario.src = usuarioAutenticado.imagen; // Cambiar a la ruta de la imagen
          imagenUsuario.style.display = 'block'; // Mostrar la imagen
          
          // Mostrar el nombre y correo del usuario
          document.getElementById('nombre-usuario').textContent = usuarioAutenticado.nombre; // Nombre del usuario
          document.getElementById('correo-usuario').textContent = usuarioAutenticado.correo; // Correo del usuario
      } else {
          // Redirigir a la página de inicio de sesión si no hay usuario autenticado
          window.location.href = 'index.html';
      }
  });
  // Seleccionamos los botones y las cards
  const agregarBtn = document.querySelector(".button-container button:first-child");
  const eliminarBtn = document.querySelector(".button-container button:last-child");
  const reservarBtn = document.querySelector(".button-container button:nth-child(2)");

  const cards = document.querySelectorAll(".card");

  // Variable para controlar la acción seleccionada
  let accionSeleccionada = null;

  // Función para manejar la selección de acción
  function seleccionarAccion(accion) {
      accionSeleccionada = accion;

      // Resaltar el botón seleccionado
      agregarBtn.classList.toggle("selected", accion === "agregar");
      eliminarBtn.classList.toggle("selected", accion === "eliminar");
      reservarBtn.classList.toggle("selected", accion === "reservar")
      
  }

  // Asignar eventos a los botones
  agregarBtn.addEventListener("click", () => seleccionarAccion("agregar"));
  eliminarBtn.addEventListener("click", () => seleccionarAccion("eliminar"));
  reservarBtn.addEventListener("click", ()=> seleccionarAccion("reservar"))

  // Función para manejar el estado de una card
  async function cambiarEstado(card) {
    const estadoActual = card.classList;
    const numeroEspacio = card.dataset.numero;
    const nombreElemento = card.querySelector('.nombre');
    const matriculaElemento = card.querySelector('.matricula');
    const horaElemento = card.querySelector('.hora');
    const fechaElemento = card.querySelector('.fecha');

    if (accionSeleccionada === "agregar") {
        // Confirmación para agregar
        const resultadoAgregar = await Swal.fire({
            title: "¿Está seguro?",
            text: "¿Está seguro de que quiere ocupar este espacio?",
            icon: "warning",
            showCancelButton: true,
            confirmButtonText: "Sí, ocupar",
            cancelButtonText: "Cancelar",
            customClass: {
                confirmButton: "swal2-confirm btn-custom-confirm",
                cancelButton: "swal2-cancel btn-custom-cancel",
                actions: "swal2-actions custom-actions"
            },
            buttonsStyling: false
        });

        if (!resultadoAgregar.isConfirmed) return; // Si cancela, salir de la función.

        if (!estadoActual.contains("occupied") && !estadoActual.contains("reserved")) {
            // Obtener el usuario autenticado del localStorage
            const usuarioAutenticado = JSON.parse(localStorage.getItem('usuarioAutenticado'));

            if (usuarioAutenticado) {
                const { nombre, matricula } = usuarioAutenticado;

                card.classList.add("occupied");
                card.classList.remove("reserved");
                card.querySelector('.card-text').textContent = `Espacio ${numeroEspacio} - Ocupado`;
                nombreElemento.textContent = `Nombre - ${nombre}`;
                matriculaElemento.textContent = `Matrícula - ${matricula}`;

                const ahora = new Date();
                const horaActual = ahora.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                const fechaActual = ahora.toLocaleDateString('es-ES'); // Formato DD/MM/YYYY
                horaElemento.textContent = `Hora - ${horaActual}`;
                fechaElemento.textContent = `Fecha - ${fechaActual}`;
            }
        }
    } else if (accionSeleccionada === "eliminar") {
        // Confirmación para eliminar
        const resultadoEliminar = await Swal.fire({
            title: "¿Está seguro?",
            text: "¿Está seguro de que quiere liberar este espacio?",
            icon: "warning",
            showCancelButton: true,
            confirmButtonText: "Sí, liberar",
            cancelButtonText: "Cancelar",
            customClass: {
                confirmButton: "swal2-confirm btn-custom-confirm",
                cancelButton: "swal2-cancel btn-custom-cancel",
                actions: "swal2-actions custom-actions"
            },
            buttonsStyling: false
        });

        if (!resultadoEliminar.isConfirmed) return; // Si cancela, salir de la función.

        if (estadoActual.contains("occupied") || estadoActual.contains("reserved")) {
            card.classList.remove("occupied", "reserved");
            card.querySelector('.card-text').textContent = `Espacio ${numeroEspacio} - Vacío`;
            nombreElemento.textContent = `Nombre - XXXXXXXX`;
            matriculaElemento.textContent = `Matrícula - XXXXXXXX`;
            horaElemento.textContent = `Hora - XX:XX`;
            fechaElemento.textContent = `Fecha - XX/XX/XXXX`;
        }
    } else if (accionSeleccionada === "reservar") {
    // Confirmación para reservar con selección de fecha y hora
    const { value: reserva } = await Swal.fire({
        title: "Reservar espacio",
        html: `
            <input type="date" id="fechaReserva" class="swal2-input" placeholder="Selecciona la fecha" min="${new Date().toISOString().split('T')[0]}">
            <input type="time" id="horaReserva" class="swal2-input" placeholder="Selecciona la hora">
        `,
        showCancelButton: true,
        confirmButtonText: "Reservar",
        cancelButtonText: "Cancelar",
        customClass: {
            confirmButton: "swal2-confirm btn-custom-confirm",
            cancelButton: "swal2-cancel btn-custom-cancel",
            actions: "swal2-actions custom-actions"
        },
        buttonsStyling: false,
        focusConfirm: false,
        preConfirm: () => {
            const fecha = document.getElementById('fechaReserva').value;
            const hora = document.getElementById('horaReserva').value;
            
            if (!fecha || !hora) {
                Swal.showValidationMessage("Por favor selecciona una fecha y una hora.");
            }
            return { fecha, hora };
        }
    });

    if (reserva) {
        let { fecha, hora } = reserva;

        // Convertir la fecha al formato DD/MM/YYYY
        fecha = fecha.split('-').reverse().join('/'); // Cambia el orden de la fecha

        if (!estadoActual.contains("occupied")) {
            const usuarioAutenticado = JSON.parse(localStorage.getItem('usuarioAutenticado'));

            if (usuarioAutenticado) {
                const { nombre, matricula } = usuarioAutenticado;

                card.classList.add("reserved");
                card.classList.remove("occupied");
                card.querySelector('.card-text').textContent = `Espacio ${numeroEspacio} - Reservado para el ${fecha} a las ${hora}`;
                nombreElemento.textContent = `Nombre - ${nombre}`;
                matriculaElemento.textContent = `Matrícula - ${matricula}`;
                horaElemento.textContent = `Hora de Reserva - ${hora}`;
                
                fechaElemento.textContent = `Fecha de Reserva - ${fecha}`;
            }
        }
    }
}

    // Desactivar la acción seleccionada después de cada operación
    desactivarAccion();
}



  // Función para desactivar la acción seleccionada
  function desactivarAccion() {
      accionSeleccionada = null;

      // Quitar el resalte de los botones
      agregarBtn.classList.remove("selected");
      eliminarBtn.classList.remove("selected");
  }

  // Agregar evento a cada card
  cards.forEach((card, index) => {
      card.dataset.numero = index + 1; // Añadir número de espacio
      card.querySelector('.card-text').textContent = `Espacio ${index + 1} - Vacío`;
      card.addEventListener("click", () => cambiarEstado(card));
  });

</script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

</html>